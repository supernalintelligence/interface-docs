/**
 * SettingsTools - Unit Tests
 * Auto-generated by Supernal Interface Test Generator
 * 
 * This file contains comprehensive tests for all @Tool decorated methods.
 * Tests include safety controls, AI execution permissions, and functionality.
 */

import { ToolRegistry } from '@supernal/interface';
import { SettingsTools } from '../../src/tools/ExampleTools';

describe('SettingsTools - Unit Tests', () => {
  let provider: SettingsTools;

  beforeEach(() => {
    provider = new SettingsTools();
    ToolRegistry.registerProvider('SettingsTools', provider);
  });

  describe('Change Setting', () => {
    test('should execute successfully with valid parameters', async () => {
      const result = await ToolRegistry.executeForTesting('SettingsTools.changeSetting', {});
      expect(result.success).toBe(true);
      expect(result.executionTime).toBeGreaterThan(0);
    });

    test('should be executable by AI (aiEnabled: true)', async () => {
      const result = await ToolRegistry.executeForAI('SettingsTools.changeSetting', {});
      expect(result.success).toBe(true);
    });

    test('should have correct metadata', () => {
      const tools = ToolRegistry.getAllTools();
      const toolMeta = tools.get('SettingsTools.changeSetting');
      
      expect(toolMeta).toBeDefined();
      expect(toolMeta!.name).toBe('Change Setting');
      expect(toolMeta!.aiEnabled).toBe(true);
      expect(toolMeta!.dangerLevel).toBe('safe');
      expect(toolMeta!.requiresApproval).toBe(false);
    });

  });

  describe('Reset Settings', () => {
    test('should execute successfully with valid parameters', async () => {
      const result = await ToolRegistry.executeForTesting('SettingsTools.resetSettings', {});
      expect(result.success).toBe(true);
      expect(result.executionTime).toBeGreaterThan(0);
    });

    test('should be executable by AI (aiEnabled: true)', async () => {
      const result = await ToolRegistry.executeForAI('SettingsTools.resetSettings', {});
      expect(result.success).toBe(false);
      expect(result.requiresApproval).toBe(true);
    });

    test('should have correct metadata', () => {
      const tools = ToolRegistry.getAllTools();
      const toolMeta = tools.get('SettingsTools.resetSettings');
      
      expect(toolMeta).toBeDefined();
      expect(toolMeta!.name).toBe('Reset Settings');
      expect(toolMeta!.aiEnabled).toBe(true);
      expect(toolMeta!.dangerLevel).toBe('dangerous');
      expect(toolMeta!.requiresApproval).toBe(true);
    });

  });

  describe('Delete All Data', () => {
    test('should execute successfully with valid parameters', async () => {
      const result = await ToolRegistry.executeForTesting('SettingsTools.deleteAllData', {});
      expect(result.success).toBe(true);
      expect(result.executionTime).toBeGreaterThan(0);
    });

    test('should be executable by AI (aiEnabled: true)', async () => {
      const result = await ToolRegistry.executeForAI('SettingsTools.deleteAllData', {});
      expect(result.success).toBe(false);
      expect(result.requiresApproval).toBe(true);
    });

    test('should have correct metadata', () => {
      const tools = ToolRegistry.getAllTools();
      const toolMeta = tools.get('SettingsTools.deleteAllData');
      
      expect(toolMeta).toBeDefined();
      expect(toolMeta!.name).toBe('Delete All Data');
      expect(toolMeta!.aiEnabled).toBe(true);
      expect(toolMeta!.dangerLevel).toBe('destructive');
      expect(toolMeta!.requiresApproval).toBe(true);
    });

  });

  describe('Safety Controls', () => {
    test('should enforce AI safety defaults', () => {
      const stats = ToolRegistry.getStats();
      
      // Verify dangerous tools require approval
      expect(stats.byDangerLevel.dangerous).toBeGreaterThanOrEqual(0);
      expect(stats.byDangerLevel.destructive).toBeGreaterThanOrEqual(0);
      
      // Verify approval requirements
      expect(stats.requiresApproval).toBeGreaterThanOrEqual(stats.byDangerLevel.dangerous + stats.byDangerLevel.destructive);
    });

    test('should prevent unauthorized destructive operations', async () => {
      const destructiveTool = 'SettingsTools.deleteAllData';
      
      // Should fail without approval
      const result = await ToolRegistry.executeForAI(destructiveTool, {});
      expect(result.success).toBe(false);
    });

  });

});
