/**
 * DataTools - Integration Tests
 * Auto-generated by Supernal Interface Test Generator
 * 
 * This file contains comprehensive tests for all @Tool decorated methods.
 * Tests include safety controls, AI execution permissions, and functionality.
 */

import { ToolRegistry } from '@supernal/interface';
import { DataTools } from '../../src/tools/ExampleTools';

describe('DataTools - Integration Tests', () => {
  let provider: DataTools;

  beforeAll(async () => {
    provider = new DataTools();
    ToolRegistry.registerProvider('DataTools', provider);
  });

  describe('Registry Integration', () => {
    test('should register all tools correctly', () => {
      const stats = ToolRegistry.getStats();
      expect(stats.totalTools).toBeGreaterThan(0);
    });

    test('should categorize tools by AI safety', () => {
      const aiTools = ToolRegistry.getAIEnabledTools();
      const stats = ToolRegistry.getStats();
      expect(stats.aiEnabled + stats.testOnly).toBe(stats.totalTools);
    });
  });

  describe('Execution Workflows', () => {
    test('should execute AI-enabled tools via executeForAI', async () => {
      const result = await ToolRegistry.executeForAI('DataTools.fetchItems', {});
      expect(result.success).toBe(true);
    });

    test('should handle approval workflow for dangerous tools', async () => {
      const approval = await ToolRegistry.requestApproval('DataTools.addItem', {});
      expect(approval.id).toBeDefined();
      expect(approval.status).toBe('pending');

      ToolRegistry.approveRequest(approval.id, 'test-user');
      const result = await ToolRegistry.executeWithApproval(approval.id);
      expect(result.success).toBe(true);
    });

  });

  describe('Natural Language Interface', () => {
    test('should find tools by natural language query', () => {
      const results = ToolRegistry.findToolsByQuery('get users');
      expect(results.length).toBeGreaterThan(0);
    });
  });
});
