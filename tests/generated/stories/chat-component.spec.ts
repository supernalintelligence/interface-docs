/**
 * ⚠️  AUTO-GENERATED FILE - DO NOT EDIT MANUALLY!
 * 
 * ❌ WARNING: ANY MANUAL EDITS WILL BE OVERWRITTEN ON NEXT GENERATION
 * 
 * This file is automatically generated from Gherkin feature files.
 * To make changes:
 *   1. Edit the .feature file in features/
 *   2. Regenerate: npx si generate-story-tests features -o tests/generated/stories
 * 
 * Generated Playwright Test
 * Feature: Chat Component
 * 
 * Generated by: GraphTestGenerator
 * Generated at: 2026-01-28T09:15:41.122Z
 */

import { test, expect } from '@playwright/test';
import { testId } from '@supernal/interface/testing';
import { Chat, Examples } from '../../../src/architecture/ComponentNames';
import { Routes } from '../../../src/architecture/Routes';
import { setComponentState, getComponentState, initializeTestState } from '@supernal/interface/testing';
import { ComponentData } from '../../../src/architecture/DemoComponentData';

test.describe('Chat Component', () => {
  test.setTimeout(30000);

  // Initialize test state manager after page navigation
  test.afterEach(async ({ page }) => {
    // Clean up test state after each test
  });

  test('Starting with empty chat', async ({ page }) => {
    // Execution order: Starting with empty chat-151 → Starting with empty chat-152 → Starting with empty chat-153 → Starting with empty chat-154 → Starting with empty chat-155 → Starting with empty chat-156
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.empty
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.empty);

    // Then Components.Chat.messages should be empty
    // Verify no user/ai chat messages exist (system messages may be present)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(0);

    // And Components.Chat.input should be enabled
    await expect(page.locator(testId(Chat.input))).toBeEnabled();

  });

  test('Sending a single message', async ({ page }) => {
    // Execution order: Sending a single message-157 → Sending a single message-158 → Sending a single message-159 → Sending a single message-160 → Sending a single message-161 → Sending a single message-162 → Sending a single message-163 → Sending a single message-164
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.empty
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.empty);

    // When I type "Hello, World!" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Hello, World!');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 1 message
    // Verify Components.Chat.messages contains 1 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(1);

    // And Components.Chat.messages last message should be "Hello, World!"
    // Verify last user message contains expected text
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"]').last()).toContainText('Hello, World!');

  });

  test('Viewing existing conversation', async ({ page }) => {
    // Execution order: Viewing existing conversation-165 → Viewing existing conversation-166 → Viewing existing conversation-167 → Viewing existing conversation-168 → Viewing existing conversation-169
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.withMessages
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.withMessages);

    // Then Components.Chat.messages should contain 2 messages
    // Verify Components.Chat.messages contains 2 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(2);

  });

  test('Adding to existing conversation', async ({ page }) => {
    // Execution order: Adding to existing conversation-170 → Adding to existing conversation-171 → Adding to existing conversation-172 → Adding to existing conversation-173 → Adding to existing conversation-174 → Adding to existing conversation-175 → Adding to existing conversation-176
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.single
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.single);

    // When I type "How are you?" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('How are you?');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 2 messages
    // Verify Components.Chat.messages contains 2 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(2);

  });

  test('Clearing all messages', async ({ page }) => {
    // Execution order: Clearing all messages-177 → Clearing all messages-178 → Clearing all messages-179 → Clearing all messages-180 → Clearing all messages-181 → Clearing all messages-182 → Clearing all messages-183
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.withMessages
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.withMessages);

    // When I click Components.Chat.clearButton
    await page.locator(testId(Chat.clearButton)).first().click();

    // Then chat state should be Components.Examples.chat.state.empty
    // State assertion: Examples.chat.state.empty
    // const state = await getComponentState(page, 'component');
    // expect(state).toEqual(Examples.chat.state.empty);

    // And Components.Chat.messages should be empty
    // Verify no user/ai chat messages exist (system messages may be present)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(0);

  });

  test('Multiple messages in sequence', async ({ page }) => {
    // Execution order: Multiple messages in sequence-184 → Multiple messages in sequence-185 → Multiple messages in sequence-186 → Multiple messages in sequence-187 → Multiple messages in sequence-188 → Multiple messages in sequence-189 → Multiple messages in sequence-190 → Multiple messages in sequence-191 → Multiple messages in sequence-192 → Multiple messages in sequence-193 → Multiple messages in sequence-194
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.empty
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.empty);

    // When I type "Hello" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Hello');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // And I type "How are you?" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('How are you?');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // And I type "Nice to meet you" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Nice to meet you');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 3 messages
    // Verify Components.Chat.messages contains 3 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(3);

  });

  test('Message persistence across actions', async ({ page }) => {
    // Execution order: Message persistence across actions-195 → Message persistence across actions-196 → Message persistence across actions-197 → Message persistence across actions-198 → Message persistence across actions-199 → Message persistence across actions-200 → Message persistence across actions-201
    // Given I am on Routes.Demo
    await page.goto(`${Routes.demo.root}`);
    await initializeTestState(page);

    // Given Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // When I click Components.Chat.bubble
    await page.locator(testId(Chat.bubble)).first().click();

    // Given chat state is Components.Examples.chat.state.single
    await setComponentState(page, 'chat', ComponentData.Examples.chat.state.single);

    // When I refresh the page
    await page.reload();
    await initializeTestState(page);

    // Then chat state should be Components.Examples.chat.state.single
    // State assertion: Examples.chat.state.single
    // const state = await getComponentState(page, 'component');
    // expect(state).toEqual(Examples.chat.state.single);

    // And Components.Chat.messages should contain 1 message
    // Verify Components.Chat.messages contains 1 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(1);

  });

});
