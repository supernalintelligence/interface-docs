/**
 * Generated Playwright Test
 * Feature: Chat Component
 * 
 * Generated by GraphTestGenerator
 * DO NOT EDIT - This file is auto-generated
 */

import { test, expect } from '@playwright/test';
import { testId } from '@supernal/interface/testing';
import { Examples, Chat, Counter, Demo, Blog } from '../../../src/architecture/DemoComponentNames';
import { setComponentState, getComponentState, initializeTestState, setChatState } from '@supernal/interface/testing';
import { ExamplesData, DemoData } from '../../../src/architecture/DemoComponentData';

test.describe('Chat Component', () => {
  test.setTimeout(30000);

  // Initialize test state manager after page navigation
  test.afterEach(async ({ page }) => {
    // Clean up test state after each test
  });

  test('Starting with empty chat', async ({ page }) => {
    // Execution order: Starting with empty chat-128 → Starting with empty chat-129 → Starting with empty chat-130 → Starting with empty chat-131 → Starting with empty chat-132
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.empty
    await setChatState(page, ExamplesData.chat.state.empty);

    // Then Components.Chat.messages should be empty
    // Verify no user/ai chat messages exist (system messages may be present)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(0);

    // And Components.Chat.input should be enabled
    await expect(page.locator(testId(Chat.input))).toBeEnabled();

  });

  test('Sending a single message', async ({ page }) => {
    // Execution order: Sending a single message-133 → Sending a single message-134 → Sending a single message-135 → Sending a single message-136 → Sending a single message-137 → Sending a single message-138 → Sending a single message-139
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.empty
    await setChatState(page, ExamplesData.chat.state.empty);

    // When I type "Hello, World!" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Hello, World!');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 1 message
    // Verify Components.Chat.messages contains 1 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(1);

    // And Components.Chat.messages last message should be "Hello, World!"
    // Verify last user message contains expected text
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"]').last()).toContainText('Hello, World!');

  });

  test('Viewing existing conversation', async ({ page }) => {
    // Execution order: Viewing existing conversation-140 → Viewing existing conversation-141 → Viewing existing conversation-142 → Viewing existing conversation-143
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.withMessages
    await setChatState(page, ExamplesData.chat.state.withMessages);

    // Then Components.Chat.messages should contain 2 messages
    // Verify Components.Chat.messages contains 2 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(2);

  });

  test('Adding to existing conversation', async ({ page }) => {
    // Execution order: Adding to existing conversation-144 → Adding to existing conversation-145 → Adding to existing conversation-146 → Adding to existing conversation-147 → Adding to existing conversation-148 → Adding to existing conversation-149
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.single
    await setChatState(page, ExamplesData.chat.state.single);

    // When I type "How are you?" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('How are you?');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 2 messages
    // Verify Components.Chat.messages contains 2 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(2);

  });

  test('Clearing all messages', async ({ page }) => {
    // Execution order: Clearing all messages-150 → Clearing all messages-151 → Clearing all messages-152 → Clearing all messages-153 → Clearing all messages-154 → Clearing all messages-155
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.withMessages
    await setChatState(page, ExamplesData.chat.state.withMessages);

    // When I click Components.Chat.clearButton
    await page.locator(testId(Chat.clearButton)).first().click();

    // Then chat state should be Components.Examples.chat.state.empty
    // State assertion: Examples.chat.state.empty
    // const state = await getComponentState(page, 'component');
    // expect(state).toEqual(Examples.chat.state.empty);

    // And Components.Chat.messages should be empty
    // Verify no user/ai chat messages exist (system messages may be present)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(0);

  });

  test('Multiple messages in sequence', async ({ page }) => {
    // Execution order: Multiple messages in sequence-156 → Multiple messages in sequence-157 → Multiple messages in sequence-158 → Multiple messages in sequence-159 → Multiple messages in sequence-160 → Multiple messages in sequence-161 → Multiple messages in sequence-162 → Multiple messages in sequence-163 → Multiple messages in sequence-164 → Multiple messages in sequence-165
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.empty
    await setChatState(page, ExamplesData.chat.state.empty);

    // When I type "Hello" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Hello');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // And I type "How are you?" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('How are you?');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // And I type "Nice to meet you" in Components.Chat.input
    await page.locator(testId(Chat.input)).fill('Nice to meet you');

    // And I click Components.Chat.sendButton
    await page.locator(testId(Chat.sendButton)).first().click();

    // Then Components.Chat.messages should contain 3 messages
    // Verify Components.Chat.messages contains 3 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(3);

  });

  test('Message persistence across actions', async ({ page }) => {
    // Execution order: Message persistence across actions-166 → Message persistence across actions-167 → Message persistence across actions-168 → Message persistence across actions-169 → Message persistence across actions-170 → Message persistence across actions-171
    // Given I am on the demo page
    await page.goto('/demo');
    await initializeTestState(page);

    // And Components.Chat.bubble is visible
    await page.locator(testId(Chat.bubble)).first().waitFor({ state: 'visible' });

    // Given chat state is Components.Examples.chat.state.single
    await setChatState(page, ExamplesData.chat.state.single);

    // When I refresh the page
    await page.reload();
    await initializeTestState(page);

    // Then chat state should be Components.Examples.chat.state.single
    // State assertion: Examples.chat.state.single
    // const state = await getComponentState(page, 'component');
    // expect(state).toEqual(Examples.chat.state.single);

    // And Components.Chat.messages should contain 1 message
    // Verify Components.Chat.messages contains 1 user/ai chat message(s)
    await expect(page.locator(testId(Chat.messages)).locator('[data-testid="chat-message-user"], [data-testid="chat-message-ai"]')).toHaveCount(1);

  });

});
